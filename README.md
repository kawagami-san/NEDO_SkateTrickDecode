# 脳波データによる動作解析: スケートボードトリック分類チャレンジ

このリポジトリは、NEDOチャレンジの一環として開発された、脳波データを用いたスケートボードトリック分類システムのソースコードを含んでいます。

## 概要

本システムは、脳波データを用いて動作を予測するモデルであり、以下の3ステップで動作します：
1. **前処理**：データの読み込みと整形
2. **学習**：遺伝的アルゴリズムによるセンサー選択とROCKETモデルの学習
3. **推論**：学習済みモデルによる予測とアンサンブル処理

### システム構成
- **前処理**：脳波データにマスクを適用し、モデル学習に適したデータ形式を整形します。
- **学習**：最適化されたマスクを使用してROCKETモデルを学習します。
- **推論**：上位3つのモデルを用いてアンサンブル予測を行い、最終的な結果を生成します。

---

## ファイル構成

### 前処理
- **ファイル**: `01.Preprocessing.ipynb`
- **目的**: 生データを学習および評価に適した形式に変換します。

### 学習
- **ファイル**: `02.Learning.ipynb`
- **目的**: 遺伝的アルゴリズムを用いたセンサー選択とモデル学習を行います。

### 推論
- **ファイル**: `03.Predicting.ipynb`
- **目的**: 学習済みモデルを使用して予測を行い、提出用ファイルを生成します。

---

## 操作方法

### 1. 前処理
1. `01.Preprocessing.ipynb`をGoogle Driveの作業用フォルダにアップロードします。
2. 以下のフォルダ構成を作成してください：
   ```
   {BASE_DIR}/
   ├── data1/
   │   ├── train/  # train.zipの内容
   │   └── test/   # test.zipの内容
   ├── data2/
   │   ├── train/  # train1.zip, train2.zipの内容
   │   └── test/   # test.zipの内容
   ```
3. ノートブック内の`BASE_DIR`を適切なパスに書き換えます。
4. セルを順に実行して学習用および推論用データを生成します。

### 2. 学習
1. `02.Learning.ipynb`を作業用フォルダにアップロードします。
2. 実行設定を調整します：
   - `BASE_DIR`: 前処理で設定したパス
   - `MODEL_NAME`: 学習セッションの識別子（例: "trial01"）
   - `NUM_POPULATIONS`、`NUM_GENERATIONS`: 遺伝的アルゴリズムのパラメータ
3. ノートブックを実行してモデルを学習します。

### 3. 推論
1. `03.Predicting.ipynb`を作業用フォルダにアップロードします。
2. 実行設定を調整します（学習と同様）。
3. ノートブックを実行して予測を生成し、`submit.csv`を確認します。

---

## アルゴリズム詳細

### 前処理
- 生データ（`.mat`ファイル）を読み込み、動作ごとのCSVファイルに変換します。

### 学習
- 遺伝的アルゴリズムを使用してセンサー選択を最適化。
- ROCKETモデルを用いて分類モデルを構築。

### 推論
- 上位3つの学習済みモデルを使用し、アンサンブルで最終予測を生成。

---

## 主な関数

### 前処理
- `make_train_data(mat_dir, save_dir)`: 学習用データを生成
- `make_val_data(mat_dir, save_dir)`: 推論用データを生成

### 学習
- `initialize_population(population_size, mask_size)`: 遺伝的アルゴリズムの初期集団を生成
- `train_rocket_model(X_train, y_train)`: ROCKETモデルの学習

### 推論
- `predict()`: 推論を実行し、結果を`submit.csv`に出力

---

## 注意点
- Google Colab環境を使用して実行します。
- EEGデータに特化した前処理および学習ステップが含まれています。

詳細については、それぞれのノートブック内のコメントをご参照ください。
